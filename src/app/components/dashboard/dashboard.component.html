<div class="dashboard-container">
  <!-- Enhanced Header with Filters -->
  <div class="dashboard-header">
    <div class="header-title">
      <h1>ğŸ¢ ×“×©×‘×•×¨×“ ××¨×›×–×™ - × ×™×”×•×œ ×§×œ×™×˜×ª × ×ª×•× ×™×</h1>
      <p class="header-subtitle">××¢×§×‘ ×—×™ ××—×¨ ×ª×”×œ×™×›×™ ×§×œ×™×˜×” ×•××™×›×•×ª × ×ª×•× ×™×</p>
    </div>
    <button class="refresh-btn" (click)="onRefreshClick()" [disabled]="loading">
      <span class="btn-icon">ğŸ”„</span>
      ×¨×¢× ×Ÿ × ×ª×•× ×™×
      <span class="last-update">×¢×•×“×›×Ÿ: {{ getLastUpdateTime() }}</span>
    </button>
  </div>

  <!-- Advanced Filters Bar -->
  <div class="filters-container">
    <div class="filters-header">
      <h3>ğŸ¯ ×¤×™×œ×˜×¨×™× ××ª×§×“××™×</h3>
      <button class="clear-filters-btn" (click)="clearFilters()">× ×§×” ×”×›×œ</button>
    </div>
    <form class="filters-grid" (ngSubmit)="onFiltersChange()">
      <div class="filter-group">
        <label class="filter-label">ğŸ“… ×˜×•×•×— ×ª××¨×™×›×™×</label>
        <div class="date-range">
          <input type="date" class="filter-input" [(ngModel)]="filters.fromDate" name="fromDate" (change)="onFiltersChange()">
          <span class="date-separator">×¢×“</span>
          <input type="date" class="filter-input" [(ngModel)]="filters.toDate" name="toDate" (change)="onFiltersChange()">
        </div>
      </div>
      
      <div class="filter-group">
        <label class="filter-label">ğŸ–¥ï¸ ××¢×¨×›×ª</label>
        <select class="filter-select" [(ngModel)]="filters.system" name="system" (change)="onFiltersChange()">
          <option value="">×›×œ ×”××¢×¨×›×•×ª</option>
          <option *ngFor="let system of dummyFilters.systems" [value]="system.id">{{ system.name }}</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label class="filter-label">ğŸ“‚ ××§×•×¨ ×§×œ×™×˜×”</label>
        <select class="filter-select" [(ngModel)]="filters.source" name="source" (change)="onFiltersChange()">
          <option value="">×›×œ ×”××§×•×¨×•×ª</option>
          <option *ngFor="let source of dummyFilters.sources" [value]="source.id">{{ source.name }}</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label class="filter-label">ğŸ“Š ×¡×˜×˜×•×¡</label>
        <select class="filter-select" [(ngModel)]="filters.status" name="status" (change)="onFiltersChange()">
          <option value="">×›×œ ×”×¡×˜×˜×•×¡×™×</option>
          <option value="pending">â³ ×‘×”××ª× ×”</option>
          <option value="processing">âš™ï¸ ×‘×ª×”×œ×™×š</option>
          <option value="success">âœ… ×”×¦×œ×—×”</option>
          <option value="failed">âŒ ×›×™×©×œ×•×Ÿ</option>
        </select>
      </div>
    </form>
  </div>

  <!-- Loading & Error States -->
  <div *ngIf="loading" class="loading-state">×˜×•×¢×Ÿ × ×ª×•× ×™×...</div>
  <div *ngIf="error" class="error-state">{{ error }}</div>

  <!-- Today's Runs Status -->
  <div class="section today-runs" *ngIf="!loading">
    <div class="section-header">
      <h2>ğŸ“ˆ ×¡×˜×˜×•×¡ ×™×•××™ ×—×™ (Today's Runs)</h2>
      <div class="live-indicator">
        <span class="pulse-dot"></span>
        ×¢×“×›×•×Ÿ ×—×™
      </div>
    </div>
    
    <div class="status-grid">
      <div class="status-card pending" [attr.data-count]="dummyData.dailyStatus.pending">
        <div class="card-icon">â³</div>
        <div class="status-number">{{ dummyData.dailyStatus.pending }}</div>
        <div class="status-label">×‘×”××ª× ×”</div>
        <div class="status-trend">+2 ××”×©×¢×”</div>
      </div>
      <div class="status-card processing" [attr.data-count]="dummyData.dailyStatus.processing">
        <div class="card-icon">âš™ï¸</div>
        <div class="status-number">{{ dummyData.dailyStatus.processing }}</div>
        <div class="status-label">×‘×ª×”×œ×™×š</div>
        <div class="status-trend">-1 ××”×©×¢×”</div>
      </div>
      <div class="status-card success" [attr.data-count]="dummyData.dailyStatus.success">
        <div class="card-icon">âœ…</div>
        <div class="status-number">{{ dummyData.dailyStatus.success }}</div>
        <div class="status-label">×”×¦×œ×—×”</div>
        <div class="status-trend">+15 ××”×©×¢×”</div>
      </div>
      <div class="status-card failed" [attr.data-count]="dummyData.dailyStatus.failed">
        <div class="card-icon">âŒ</div>
        <div class="status-number">{{ dummyData.dailyStatus.failed }}</div>
        <div class="status-label">×›×™×©×œ×•×Ÿ</div>
        <div class="status-trend">+1 ××”×©×¢×”</div>
      </div>
    </div>
    
    <div class="kpi-grid">
      <div class="kpi-card highlight">
        <div class="kpi-icon">ğŸ¯</div>
        <div class="kpi-value">{{ dummyData.kpis.totalRuns }}</div>
        <div class="kpi-label">××¡×¤×¨ ×”×¨×¦×•×ª ×”×™×•×</div>
      </div>
      <div class="kpi-card success">
        <div class="kpi-icon">ğŸ“Š</div>
        <div class="kpi-value">{{ dummyData.kpis.successRate }}%</div>
        <div class="kpi-label">××—×•×– ×”×¦×œ×—×•×ª</div>
      </div>
      <div class="kpi-card time">
        <div class="kpi-icon">â±ï¸</div>
        <div class="kpi-value">{{ dummyData.kpis.avgTime }}</div>
        <div class="kpi-label">×–××Ÿ ×§×œ×™×˜×” ×××•×¦×¢</div>
      </div>
      <div class="kpi-card time">
        <div class="kpi-icon">ğŸ“</div>
        <div class="kpi-value">{{ dummyData.kpis.medianTime }}</div>
        <div class="kpi-label">×–××Ÿ ×§×œ×™×˜×” ×—×¦×™×•× ×™</div>
      </div>
      <div class="kpi-card sla">
        <div class="kpi-icon">ğŸ–ï¸</div>
        <div class="kpi-value">{{ dummyData.kpis.slaCompliance }}%</div>
        <div class="kpi-label">SLA ×¢××™×“×•×ª</div>
      </div>
    </div>
  </div>

  <!-- Queue & Errors Row -->
  <div class="row-section">
    <!-- Queue -->
    <div class="half-section queue-section">
      <div class="section-header">
        <h2>ğŸ“‹ ×ª×•×¨ ×§×‘×¦×™× ×××ª×™× ×™× (Queue)</h2>
        <span class="queue-total">{{ dummyData.queue.length }} ××§×•×¨×•×ª</span>
      </div>
      <div class="queue-list">
        <div class="queue-item" *ngFor="let item of dummyData.queue" [class]="item.priority">
          <div class="queue-info">
            <div class="source-name">
              <span class="source-icon">{{ item.icon }}</span>
              {{ item.sourceName }}
            </div>
            <div class="queue-details">
              <span class="queue-count">{{ item.fileCount }} ×§×‘×¦×™× ×××ª×™× ×™×</span>
              <span class="queue-size">{{ item.totalSize }}</span>
            </div>
          </div>
          <div class="queue-timing">
            <div class="eta" [class]="item.urgency">ETA: {{ item.eta }}</div>
            <div class="sla-status" [class]="item.slaStatus">SLA: {{ item.slaWindow }}</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Top Errors -->
    <div class="half-section errors-section">
      <div class="section-header">
        <h2>ğŸš¨ ×©×’×™××•×ª ××•×‘×™×œ×•×ª (Top Errors)</h2>
        <span class="errors-total">{{ dummyData.topErrors.length }} ×¡×•×’×™ ×©×’×™××•×ª</span>
      </div>
      <div class="errors-list">
        <div class="error-item" *ngFor="let error of dummyData.topErrors; let i = index" (click)="onErrorClick(error.code)">
          <div class="error-rank">{{ i + 1 }}</div>
          <div class="error-info">
            <div class="error-code">{{ error.code }}</div>
            <div class="error-desc">{{ error.description }}</div>
            <div class="error-fields">×©×“×•×ª: {{ error.affectedFields.join(', ') }}</div>
          </div>
          <div class="error-stats">
            <div class="error-count">{{ error.count }}</div>
            <div class="error-trend" [class]="error.trend">{{ error.trendIcon }} {{ error.trendText }}</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Problematic Sources & Throughput -->
  <div class="row-section">
    <div class="half-section sources-section">
      <div class="section-header">
        <h2>âš ï¸ ××§×•×¨×•×ª ×‘×¢×™×™×ª×™×™×</h2>
        <span class="sources-count">{{ dummyData.problematicSources.length }} ××§×•×¨×•×ª ×‘×¡×™×›×•×Ÿ</span>
      </div>
      <div class="sources-list">
        <div class="source-item" *ngFor="let source of dummyData.problematicSources" [class]="source.riskLevel">
          <div class="source-info">
            <div class="source-name">
              <span class="risk-icon">{{ source.riskIcon }}</span>
              {{ source.name }}
            </div>
            <div class="source-issues">
              <span class="issue-tag" *ngFor="let issue of source.issues">{{ issue }}</span>
            </div>
          </div>
          <div class="source-stats">
            <div class="failure-rate">{{ source.failureRate }}% ×›×™×©×œ×•×Ÿ</div>
            <div class="avg-time">{{ source.avgTime }} ×–××Ÿ ×××•×¦×¢</div>
            <button class="source-link" (click)="navigateToSource(source.id)">ğŸ”— ×¤×¨×˜×™×</button>
          </div>
        </div>
      </div>
    </div>

    <div class="half-section throughput-section">
      <div class="section-header">
        <h2>ğŸ“ˆ ×”×–×¨××”/×ª×¤×•×§×” (Throughput)</h2>
        <div class="chart-controls">
          <button class="chart-btn active">×™×•×</button>
          <button class="chart-btn">×©×‘×•×¢</button>
        </div>
      </div>
      <div class="throughput-chart">
        <div class="chart-placeholder">
          <div class="chart-icon">ğŸ“Š</div>
          <div class="chart-title">×’×¨×£ ×§×¦×‘ ×§×œ×™×˜×•×ª</div>
          <div class="chart-subtitle">×ª×¤×•×§×” ×œ××•×¨×š ×”×™×•×</div>
        </div>
        <div class="throughput-stats">
          <div class="stat-item">
            <span class="stat-icon">ğŸ“</span>
            <span class="stat-value">{{ dummyData.throughput.files | number }}</span>
            <span class="stat-label">×§×‘×¦×™×</span>
          </div>
          <div class="stat-item">
            <span class="stat-icon">ğŸ“Š</span>
            <span class="stat-value">{{ dummyData.throughput.records | number }}</span>
            <span class="stat-label">×¨×©×•××•×ª</span>
          </div>
          <div class="stat-item">
            <span class="stat-icon">ğŸ’¾</span>
            <span class="stat-value">{{ dummyData.throughput.dataVolume }}</span>
            <span class="stat-label">× ×¤×— × ×ª×•× ×™×</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Data Quality & Alerts -->
  <div class="row-section">
    <div class="half-section quality-section">
      <div class="section-header">
        <h2>ğŸ¯ ××™×›×•×ª × ×ª×•× ×™× (Data Quality KPIs)</h2>
        <span class="quality-score" [class]="getQualityScoreClass()">×¦×™×•×Ÿ: {{ dummyData.dataQuality.overallScore }}/100</span>
      </div>
      <div class="quality-metrics">
        <div class="quality-item critical">
          <div class="metric-info">
            <span class="metric-icon">ğŸš«</span>
            <span class="metric-label">××—×•×– ×©×•×¨×•×ª ×¤×’×•××•×ª</span>
          </div>
          <div class="metric-value">{{ dummyData.dataQuality.corruptedRowsPercent }}%</div>
          <div class="metric-details">{{ dummyData.dataQuality.corruptedRows | number }} ××ª×•×š {{ dummyData.dataQuality.totalRows | number }}</div>
        </div>
        <div class="quality-item warning">
          <div class="metric-info">
            <span class="metric-icon">âš ï¸</span>
            <span class="metric-label">×¢××•×“×•×ª ×¢× ×”×¤×¨×•×ª ×•×œ×™×“×¦×™×”</span>
          </div>
          <div class="validation-columns">
            <div class="column-violation" *ngFor="let col of dummyData.dataQuality.violationColumns">
              <span class="column-name">{{ col.name }}</span>
              <span class="violation-count">{{ col.violations }} ×”×¤×¨×•×ª</span>
            </div>
          </div>
        </div>
        <div class="quality-item info">
          <div class="metric-info">
            <span class="metric-icon">ğŸ“‹</span>
            <span class="metric-label">××™×›×•×ª ×œ×¤×™ ××§×•×¨</span>
          </div>
          <div class="source-quality">
            <div class="source-quality-item" *ngFor="let sq of dummyData.dataQuality.sourceQuality">
              <span class="source-name">{{ sq.sourceName }}</span>
              <div class="quality-bar">
                <div class="quality-fill" [style.width.%]="sq.qualityScore"></div>
              </div>
              <span class="quality-percent">{{ sq.qualityScore }}%</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="half-section alerts-section">
      <div class="section-header">
        <h2>ğŸ”” ×”×ª×¨××•×ª ××—×¨×•× ×•×ª</h2>
        <span class="alerts-count">{{ dummyData.recentAlerts.length }} ×”×ª×¨××•×ª ×¤×¢×™×œ×•×ª</span>
      </div>
      <div class="alerts-list">
        <div class="alert-item" *ngFor="let alert of dummyData.recentAlerts" [class]="alert.severity">
          <div class="alert-header">
            <span class="alert-time">{{ alert.time }}</span>
            <span class="alert-severity" [class]="alert.severity">{{ alert.severityText }}</span>
          </div>
          <div class="alert-content">
            <div class="alert-msg">{{ alert.message }}</div>
            <div class="alert-details">
              <span class="alert-recipient">× ×©×œ×— ×œ: {{ alert.sentTo }}</span>
              <span class="alert-about">×¢×œ: {{ alert.about }}</span>
            </div>
          </div>
          <div class="alert-status" [class]="alert.handlingStatus">
            {{ alert.handlingStatusText }}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>